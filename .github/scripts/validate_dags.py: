import ast
import sys
import os

dags_folder = "dags"
failed = False

for filename in os.listdir(dags_folder):
    if filename.endswith(".py"):
        filepath = os.path.join(dags_folder, filename)
        with open(filepath) as f:
            source = f.read()
        try:
            ast.parse(source)
            print(f"{filepath} - OK")
        except SyntaxError as e:
            print(f"{filepath} - FAILED: {e}")
            failed = True

if failed:
    sys.exit(1)
